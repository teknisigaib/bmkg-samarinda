// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

// prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL") // Ini akan baca Port 6543
  directUrl = env("DIRECT_URL")   // Ini akan baca Port 5432
}

// ------------------------------------
// Tabel 1: Berita & Kegiatan
// ------------------------------------
model Post {
  id          String   @id @default(cuid()) // ID unik otomatis (cth: clh123...)
  title       String
  slug        String   @unique // URL harus unik
  category    String   // 'Berita', 'Kegiatan', 'Edukasi'
  content     String   @db.Text // Isi HTML panjang
  excerpt     String   // Ringkasan
  imageUrl    String?  // Link gambar (Opsional/Boleh kosong ditandai ?)
  author      String   @default("Admin")
  isFeatured  Boolean  @default(false)
  createdAt   DateTime @default(now()) // Tanggal otomatis saat dibuat
  updatedAt   DateTime @updatedAt      // Tanggal otomatis saat diedit

  @@map("posts") // Nama tabel di database nanti jadi 'posts' (huruf kecil)
}

// ------------------------------------
// Tabel 2: Publikasi (Buletin, Artikel, Makalah)
// ------------------------------------
model Publication {
  id        String   @id @default(cuid())
  type      String   // 'Buletin', 'Artikel', 'Makalah'
  title     String
  slug      String?  @unique // Opsional, Buletin mungkin tidak butuh slug halaman detail
  author    String   @default("Tim BMKG")
  year      String   // '2024', '2023'
  edition   String?  // Khusus Buletin ('November')
  abstract  String?  @db.Text // Ringkasan (Makalah/Artikel)
  tags      String[] // Array: ["Iklim", "Radar"] (Fitur keren Postgres)
  coverUrl  String?  // Link Cover Gambar
  pdfUrl    String   // Link File PDF (Wajib)
  createdAt DateTime @default(now())

  @@map("publications")
}

// ------------------------------------
// Tabel 3: Iklim
// ------------------------------------
model ClimateData {
  id        String   @id @default(cuid())
  type      String   // 'HTH', 'HujanDasarian', 'HujanBulanan', 'PotensiBanjir'
  title     String   // Judul
  period    String   // Detail Tanggal: "21 - 30 November 2024"
  dasarian  String   // "Dasarian III"
  bulan     String   // "November 2024"
  content   String   @db.Text // Analisis
  imageUrl  String   // Peta
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("climate_data")
}


// ------------------------------------
// Tabel 4: Data Pegawai (BARU)
// ------------------------------------
model Employee {
  id        String   @id @default(cuid())
  name      String
  position  String   // Jabatan
  group     String   // 'Pimpinan', 'Struktural', 'Fungsional'
  image     String?  // URL Foto profil
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("employees") // Nama tabel di Supabase nanti 'employees'
}


// ------------------------------------
// Tabel 5: Dokumen Kinerja (Transparansi)
// ------------------------------------
model PerformanceDoc {
  id        String   @id @default(cuid())
  title     String   // Nama Dokumen (e.g. "Laporan Kinerja 2024")
  category  String   // 'Renstra', 'RencanaKinerja', 'PerjanjianKinerja', 'LaporanKinerja'
  year      String   // '2024'
  fileUrl   String   // Link PDF dari Supabase
  fileSize  String?  // Opsional: "2.5 MB" (Jika bisa didapat dari file object)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("performance_docs")
}



// ------------------------------------
// Tabel 6: Data Hotspot (Karhutla)
// ------------------------------------
model Hotspot {
  id          String   @id @default(cuid())
  latitude    Float
  longitude   Float
  confidence  Int?     // Tingkat kepercayaan (8, 9, dst)
  province    String   // KALIMANTAN TIMUR
  district    String   // PASER
  subDistrict String   // BATU SOPANG
  satellite   String   // SNPP, NOAA20
  date        DateTime // 2025-12-22
  createdAt   DateTime @default(now())

  @@map("hotspots")
}